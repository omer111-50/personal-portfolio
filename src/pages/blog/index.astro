---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import Layout from '@/layouts/Layout.astro';
import Footer from '@/components/Footer.tsx';
import FormattedDate from "@/lib/utils.ts";
import Header from '@/components/Header.tsx';
import { SITE_DESCRIPTION, SITE_TITLE } from '@/lib/consts.ts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<Layout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<!-- Header -->
	<Header client:only="react" pathname={Astro.url.pathname} />
	
	<main class="flex-1 container max-w-5xl mx-auto px-6 md:px-4 py-8">
		<section>
			<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
				{
					posts.map((post, index) => (
						<article class={`group ${index === 0 ? 'md:col-span-2' : ''}`}>
							<a href={`/blog/${post.id}/`} class="block">
								{post.data.heroImage && (
									<div class="mb-4 overflow-hidden rounded-lg">
										<Image 
											width={720} 
											height={360} 
											src={post.data.heroImage} 
											alt={post.data.title}
											class="w-full h-auto transition-transform duration-300 group-hover:scale-105"
										/>
									</div>
								)}
								<div class={`${index === 0 ? 'text-center' : ''}`}>
									<h2 class={`font-bold text-gray-900 transition-colors duration-300 group-hover:text-purple-600 ${
										index === 0 ? 'text-3xl md:text-4xl mb-2' : 'text-xl mb-2'
									}`}>
										{post.data.title}
									</h2>
									<p class="text-gray-600 text-sm">
										<FormattedDate date={post.data.pubDate} />
									</p>
								</div>
							</a>
						</article>
					))
				}
			</div>
		</section>
	</main>
	
	<!-- Footer -->
	<Footer client:only="react" />
</Layout>
